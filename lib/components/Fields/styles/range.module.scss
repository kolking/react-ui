@use '../../../styles/utils' as *;

@mixin track() {
  appearance: none;
  box-sizing: border-box;
  height: var(--track-height);
  background-color: var(--track-color-1);
  border-radius: calc(var(--track-height) / 2);
  background: linear-gradient(
    to right,
    var(--track-color-2) var(--progress),
    var(--track-color-1) var(--progress),
  );
}

@mixin thumb() {
  appearance: none;
  border-radius: 50%;
  box-sizing: border-box;
  width: var(--thumb-size);
  height: var(--thumb-size);
  background-color: var(--thumb-color);
  margin-top: calc((var(--track-height) - var(--thumb-size)) / 2);
  border: var(--thumb-border-width) solid var(--thumb-border-color);

  @media (prefers-reduced-motion: no-preference) {
    transition: outline 0.1s;
  }
}

.range {
  --width: 100%;
  --progress: 50%;
  --thumb-size: 1.25em;
  --track-height: 0.25em;
  --thumb-border-width: 0.125em;
  --track-color-1: var(--color-gray-300);
  --track-color-2: var(--color-accent-500);
  --thumb-color: var(--color-white);
  --thumb-border-color: var(--color-accent-500);

  --size: var(--size-md);
  --size-xs: var(--font-size-xs);
  --size-sm: var(--font-size-sm);
  --size-md: var(--font-size-md);
  --size-lg: var(--font-size-lg);
  --size-xl: var(--font-size-xl);

  margin: 0;
  padding: 0;
  appearance: none;
  width: var(--width);
  font-size: var(--size);
  min-height: var(--thumb-size);

  &:focus-visible {
    outline: none;

    &::-webkit-slider-thumb {
      @include focus-visible();
    }
  }

  &[data-invalid=true] {
    --color-focus: var(--input-error-focus-color);
    --track-color-2: var(--input-error-border-color);
    --thumb-border-color: var(--input-error-border-color);
  }

  &[disabled] {
    --track-color-1: var(--color-gray-300);
    --track-color-2: var(--color-gray-300);
    --thumb-border-color: var(--color-gray-400);
  }

  &::-webkit-slider-runnable-track {
    @include track();
  }

  &::-webkit-slider-thumb {
    @include thumb();
  }

  &::-moz-range-track {
    @include track();
  }

  &::-moz-range-thumb {
    @include thumb();
  }
}

.slider {
  display: flex;
  --width: 100%;
  --progress: 50;
  --thumb-size: 1.25em;
  --track-height: 0.25em;
  --thumb-border-width: 0.125em;
  --track-color-1: var(--color-gray-300);
  --track-color-2: var(--color-accent-500);
  --thumb-color: var(--color-white);
  --thumb-border-color: var(--color-accent-500);

  --size: var(--size-md);
  --size-xs: var(--font-size-xs);
  --size-sm: var(--font-size-sm);
  --size-md: var(--font-size-md);
  --size-lg: var(--font-size-lg);
  --size-xl: var(--font-size-xl);

  // margin: 0;
  // padding: 0;
  // appearance: none;
  position: relative;
  width: var(--width);
  font-size: var(--size);
  min-height: var(--thumb-size);

  &_track {
    width: 100%;
    // appearance: none;
    // box-sizing: border-box;
    height: var(--track-height);
    background-color: var(--track-color-1);
    border-radius: calc(var(--track-height) / 2);
    background: linear-gradient(
      to right,
      var(--track-color-2) calc(var(--progress) * 100%),
      var(--track-color-1) calc(var(--progress) * 100%),
    );  
  }

  &_thumb {
    left: calc(var(--progress) * (100% - var(--thumb-size)));
    position: absolute;
    //appearance: none;
    border-radius: 50%;
    //box-sizing: border-box;
    width: var(--thumb-size);
    height: var(--thumb-size);
    background-color: var(--thumb-color);
    margin-top: calc((var(--track-height) - var(--thumb-size)) / 2);
    border: var(--thumb-border-width) solid var(--thumb-border-color);
  
    @media (prefers-reduced-motion: no-preference) {
      transition: outline 0.1s;
    }  
  }
}